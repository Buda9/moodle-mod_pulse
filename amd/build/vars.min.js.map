{"version":3,"file":"vars.min.js","sources":["../src/vars.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * vars javascript to place the placeholders.\r\n * Modified version of IOMAD Email template emailvars.\r\n *\r\n * @module   mod_pulse/vars\r\n * @copyright 2023, bdecent gmbh bdecent.de\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(\"mod_pulse/vars\", [\"jquery\", 'core/str'], (function($, Str) {\r\n\r\n    /**\r\n     * Toggle the placeholder container hide/show.\r\n     */\r\n    const initPlaceholderToggle = function() {\r\n\r\n        var selector = \".mod-pulse-emailvars-toggle\";\r\n\r\n        var emailvars = document.querySelectorAll(selector);\r\n\r\n        if (emailvars === undefined || emailvars === null) {\r\n            return;\r\n        }\r\n\r\n        emailvars.forEach((editor) => {\r\n            editor.querySelector('.email-vars-button').addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n\r\n                var target = e.target.closest('a');\r\n                var bodyID = target.getAttribute('href'); // Get the clicked placeholder element vars content selector.\r\n                var toggleIcon = target.querySelector('i');\r\n                var varsContent = document.querySelector(bodyID) // Email vars content body.\r\n\r\n                varsContent.classList.toggle('show');\r\n\r\n                // Change the toggle icon direction.\r\n                toggleIcon.classList.toggle('fa-angle-double-up');\r\n                toggleIcon.classList.toggle('fa-angle-double-down');\r\n            })\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Email vars placeholders show more / show less.\r\n     */\r\n    const initVarsExpand = function() {\r\n        var selector = '.mod-pulse-emailvars-toggle .pulse-email-placeholders li .button-show-more';\r\n\r\n        var placeholders = document.querySelectorAll(selector)\r\n\r\n        if (placeholders === undefined || placeholders === null) {\r\n            return;\r\n        }\r\n\r\n        placeholders.forEach((showmorebtn) => {\r\n            showmorebtn.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                var target = e.target.closest('a');\r\n                var bodyID = target.getAttribute('href'); // Get the clicked show more element placeholder content selector.\r\n                var placeholderContent = document.querySelector(bodyID); // Placeholder content body.\r\n                placeholderContent.classList.toggle('less');\r\n\r\n                if (target.innerHTML == 'Show more') {\r\n                    var showless = Str.get_string('showless', 'mod_pulse');\r\n                    showless.done(function(localizedShowlessString) {\r\n                        target.innerHTML = localizedShowlessString;\r\n                    });\r\n                } else {\r\n                    var showmore = Str.get_string('showmore', 'mod_pulse');\r\n                    showmore.done(function(localizedShowmoreString) {\r\n                        target.innerHTML = localizedShowmoreString;\r\n                    });\r\n                }\r\n            })\r\n        })\r\n    }\r\n    \r\n    return {\r\n\r\n        init: function() {\r\n            initPlaceholderToggle();\r\n            initVarsExpand();\r\n        },\r\n    };\r\n\r\n}));"],"names":["define","$","Str","init","emailvars","placeholders","document","querySelectorAll","forEach","editor","querySelector","addEventListener","e","preventDefault","target","closest","bodyID","getAttribute","toggleIcon","classList","toggle","showmorebtn","innerHTML","get_string","done","localizedShowlessString","localizedShowmoreString"],"mappings":";;;;;;;;AAwBAA,wBAAyB,CAAC,SAAU,aAAc,SAASC,EAAGC,WAoEnD,CAEHC,KAAM,WAjEoB,IAItBC,UA8BAC,aA5BAD,OAFAA,UAAYE,SAASC,iBAFV,iCAQfH,UAAUI,SAASC,SACfA,OAAOC,cAAc,sBAAsBC,iBAAiB,SAAUC,IAClEA,EAAEC,qBAEEC,OAASF,EAAEE,OAAOC,QAAQ,KAC1BC,OAASF,OAAOG,aAAa,QAC7BC,WAAaJ,OAAOJ,cAAc,KACpBJ,SAASI,cAAcM,QAE7BG,UAAUC,OAAO,QAG7BF,WAAWC,UAAUC,OAAO,sBAC5BF,WAAWC,UAAUC,OAAO,8BAahCf,OAFAA,aAAeC,SAASC,iBAFb,gFAQfF,aAAaG,SAASa,cAClBA,YAAYV,iBAAiB,SAAUC,IACnCA,EAAEC,qBACEC,OAASF,EAAEE,OAAOC,QAAQ,KAC1BC,OAASF,OAAOG,aAAa,QACRX,SAASI,cAAcM,QAC7BG,UAAUC,OAAO,QAEZ,aAApBN,OAAOQ,UACQpB,IAAIqB,WAAW,WAAY,aACjCC,MAAK,SAASC,yBACnBX,OAAOQ,UAAYG,2BAGRvB,IAAIqB,WAAW,WAAY,aACjCC,MAAK,SAASE,yBACnBZ,OAAOQ,UAAYI"}